<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/558ca1a6aa3cb55e-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/8b338a9e5eebdb00.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-e7e2e9d366afa4de.js"/><script src="/_next/static/chunks/4bd1b696-44ae86a34ede646f.js" async=""></script><script src="/_next/static/chunks/684-25326233eda1da41.js" async=""></script><script src="/_next/static/chunks/main-app-79e5b1a389d0fe5b.js" async=""></script><script src="/_next/static/chunks/874-74901d351483b694.js" async=""></script><script src="/_next/static/chunks/app/posts/%5Bslug%5D/page-f9e0a1a25b6c6997.js" async=""></script><meta name="next-size-adjust" content=""/><title>Protein Language Models for Immunoglobulin Sequence Analysis | Michael Swift</title><meta name="description" content="Do protein language models capture meaningful features of antibody sequences?"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="128x128"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="__variable_f9e569 antialiased font-mono bg-background text-foreground"><!--$--><div class="min-h-screen bg-background"><div class="max-w-4xl mx-auto px-6 py-12"><a class="inline-flex items-center gap-2 text-sm text-muted-foreground hover:text-foreground mb-8 transition-colors" href="/#posts"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-arrow-left" aria-hidden="true"><path d="m12 19-7-7 7-7"></path><path d="M19 12H5"></path></svg>Back to posts</a><header class="mb-8"><div class="mb-4"><h1 class="text-4xl md:text-5xl font-serif font-bold leading-tight">Protein Language Models for Immunoglobulin Sequence Analysis</h1></div><div class="text-muted-foreground">March 4, 2023</div><div class="flex flex-wrap gap-2 mt-4"><span class="px-2 py-1 text-xs bg-secondary text-secondary-foreground rounded">protein-language-models</span><span class="px-2 py-1 text-xs bg-secondary text-secondary-foreground rounded">computational-biology</span><span class="px-2 py-1 text-xs bg-secondary text-secondary-foreground rounded">immunoinformatics</span><span class="px-2 py-1 text-xs bg-secondary text-secondary-foreground rounded">single-cell-transcriptomics</span><span class="px-2 py-1 text-xs bg-secondary text-secondary-foreground rounded">antibody-repertoire</span><span class="px-2 py-1 text-xs bg-secondary text-secondary-foreground rounded">somatic-hypermutation</span><span class="px-2 py-1 text-xs bg-secondary text-secondary-foreground rounded">immunoglobulin-analysis</span></div></header><article class="prose prose-lg max-w-none  prose-headings:font-serif prose-headings:font-semibold prose-headings:text-foreground prose-h1:text-3xl prose-h1:md:text-4xl prose-h1:mb-6 prose-h1:mt-8 prose-h2:text-2xl prose-h2:md:text-3xl prose-h2:mb-4 prose-h2:mt-8 prose-h3:text-xl prose-h3:md:text-2xl prose-h3:mb-3 prose-h3:mt-6 prose-p:text-base prose-p:md:text-lg prose-p:leading-relaxed prose-p:mb-6 prose-p:font-serif prose-p:text-muted-foreground prose-strong:font-semibold prose-strong:text-foreground prose-a:text-primary prose-a:no-underline hover:prose-a:underline prose-ul:mb-6 prose-ul:space-y-2 prose-li:text-base prose-li:md:text-lg prose-li:font-serif prose-li:text-muted-foreground prose-ol:mb-6 prose-ol:space-y-2 prose-blockquote:border-l-4 prose-blockquote:border-primary prose-blockquote:pl-4 prose-blockquote:italic prose-blockquote:text-muted-foreground prose-code:bg-[#fdf6e3] prose-code:text-[#657b83] prose-code:px-1 prose-code:py-0.5 prose-code:rounded prose-code:text-sm prose-code:font-mono prose-code:border prose-code:border-[#eee8d5] prose-pre:bg-[#fdf6e3] prose-pre:text-[#657b83] prose-pre:p-4 prose-pre:rounded-lg prose-pre:overflow-x-auto prose-pre:border prose-pre:border-[#eee8d5] prose-pre:shadow-sm prose-pre:font-mono prose-pre:text-sm prose-pre:leading-relaxed [&amp;_.hljs]:bg-transparent [&amp;_.hljs]:text-inherit prose-img:rounded-lg prose-img:shadow-sm prose-img:max-w-[60%] prose-img:mx-auto [&amp;_img]:max-w-[60%] [&amp;_img]:mx-auto [&amp;_img]:block"><div><p><img src="/images/posts/llm_antibody/llm_ir-writeup_38_0.png" alt="png"></p>
<p>I investigated the application of protein language models (PLMs) for immunoglobulin sequence analysis. Antibodies are adaptive immune proteins critical for pathogen neutralization. This study integrates B-cell receptor (BCR) sequencing data, AbLang (an antibody-specific protein language model), and single-cell RNA sequencing to explore computational approaches in immunoinformatics.</p>

<h3>Protein Language Models in Structural Biology</h3>
<p>Protein language models leverage transformer architectures adapted from natural language processing to analyze amino acid sequences. These models undergo unsupervised pre-training on large-scale protein databases, learning evolutionary constraints and structural motifs encoded in sequence space. Through self-attention mechanisms, they capture long-range amino acid dependencies critical for protein folding and function. The learned representations encode biophysical properties including secondary structure, solvent accessibility, and functional domains. I investigated their application to immunoglobulin evolution and somatic hypermutation analysis.</p>
<h3>AbLang: Antibody-Specific Protein Language Model</h3>
<p><img src="/images/posts/llm_antibody/llm_ir-writeup_7_0.jpg" alt="jpeg"></p>
<p>AbLang is a domain-specific protein language model trained exclusively on immunoglobulin sequences, optimizing representations for antibody variable regions. While domain-specific models may capture immunoglobulin-specific evolutionary patterns, comparative analysis with general protein language models (e.g., ESM-2, ProtTrans) would provide valuable benchmarking for immunoinformatics applications.</p>
<h3>Additional Background about Antibodies at the bottom:</h3>
<p>Somatic hypermutation frequency serves as a molecular marker of affinity maturation, with higher mutation loads indicating extensive germinal center selection and clonal evolution from naive B-cell precursors.</p>
<h2>Overview of my investigation:</h2>
<ul>
<li>integrate single-cell transcriptomic profiles with AbLang-derived immunoglobulin embeddings</li>
<li>apply principal component analysis to protein language model representations</li>
<li>perform unsupervised clustering of immunoglobulin sequence embeddings</li>
<li>conduct differential gene expression analysis using embedding-defined B-cell subpopulations</li>
<li>generate low-dimensional visualizations via UMAP projection</li>
</ul>
<h2>Protein Language Models for Immunoglobulin Analysis in Single-Cell Genomics</h2>
<p>A Quick Look at the Dataset</p>
<p><img src="/images/posts/llm_antibody/llm_ir-writeup_18_0.png" alt="png"></p>
<p>The dataset comprises hundreds to thousands of individual B cells per sample, each with paired single-cell transcriptomic profiles and cognate immunoglobulin heavy and light chain sequences.</p>
<p>These UMAP projections demonstrate global coherence between transcriptomic states and immunoglobulin sequence characteristics:</p>
<ol>
<li>UMAP projections of single-cell transcriptomic data colored by B-cell developmental state (left) and immunoglobulin sequence features (right panels)</li>
<li>Memory B cells represent antigen-experienced populations with accumulated somatic hypermutations, while naive B cells maintain germline immunoglobulin sequences</li>
<li>Mutation frequency is quantified as nucleotide divergence from inferred germline V(D)J gene segments</li>
<li>Memory B cells exhibit class switch recombination from IgM to downstream isotypes (IgG, IgA, IgE), indicating germinal center participation</li>
</ol>
<p><img src="/images/posts/llm_antibody/llm_ir-writeup_21_1.png" alt="png"></p>
<p>Immunoglobulin sequence annotations demonstrate strong concordance with transcriptomically-defined B-cell subsets. Memory B cells predominantly harbor hypermutated immunoglobulin sequences, confirming the molecular signatures of germinal center-derived populations.</p>
<p>I investigated whether protein language model embeddings capture biologically meaningful immunoglobulin features including somatic hypermutation and isotype usage. The following PCA analysis examines these categorical variables within AbLang embedding space:</p>
<p><img src="/images/posts/llm_antibody/llm_ir-writeup_26_0.png" alt="png"></p>
<p>The protein language model demonstrates learned representations of somatic hypermutation, cleanly separating germline from hypermutated immunoglobulins along PC1 and PC3. PC3 reveals continuous variation within hypermutated sequence space, with a clear trajectory from IgM to class-switched isotypes (IgG, IgA). This suggests the model captures fundamental immunoglobulin biology including affinity maturation and class switch recombination.</p>
<p>Quantitative analysis of somatic hypermutation along principal components, particularly PC3 which separates IgM from class-switched isotypes, reveals corresponding patterns in transcriptomic space:</p>
<p><img src="/images/posts/llm_antibody/llm_ir-writeup_29_1.png" alt="png"></p>
<p>As an aside, we can see a fair amount of "no mutation" antibody sequences (highighted in the red box or seen in the tail of the orange distribtion) that actually appear more like mutated antibodies in the PC space. I asked if the gene expression of cells with that profile looked like Memory B cells, which would corroborate that the antibody actually is hypermutated. Indeed these cells with "no mutations" appear to have a memory-like phenotype, suggesting the language model identifies mutations in antibodies more sensitively than how I orginally labeled the mutation status, via comparison to a genomic database.</p>
<p>I noticed from some exploratory plots that the while the distribution of hypermutated antibodies on PC3 doesn't appear to have any notable features, if I subset different cell types, multiple modes appear. For example, hypermutated Memory B cells appear to have multple two modes in PC3</p>
<p><img src="/images/posts/llm_antibody/llm_ir-writeup_32_1.png" alt="png"></p>
<p>I split the hypermutated Memory B cells at 1 in PC3 space and asked if there were gene expression differences between the groups</p>
<p><img src="/images/posts/llm_antibody/llm_ir-writeup_35_1.png" alt="png"></p>
<p>Indeed there are clear differences, with PC3 low having a IGHM memory phenotype and PC3 high  deeper or class-switched memory phenotype</p>
<p>Let's finally take a quick look at the UMAP projection of the antibody sequence encodings</p>
<p><img src="/images/posts/llm_antibody/llm_ir-writeup_38_0.png" alt="png"></p>
<p><img src="/images/posts/llm_antibody/llm_ir-writeup_38_1.png" alt="png"></p>
<p>UMAP projection demonstrates clustering by V gene family usage alongside somatic hypermutation levels. Immunoglobulin sequences cluster by germline V gene origin, with secondary separation of hypermutated variants within each gene family, reflecting both germline diversity and somatic evolution.</p>
<h3>Summary:</h3>
<p>This immunoinformatics analysis demonstrates that protein language models capture biologically relevant immunoglobulin features:</p>
<ul>
<li>AbLang embeddings encode somatic hypermutation along orthogonal dimensions</li>
<li>Binary germline vs. hypermutated classification along one axis</li>
<li>Continuous mutation load quantification along another axis</li>
<li>Embedding-based immunoglobulin clustering correlates with independent transcriptomic B-cell phenotypes</li>
</ul>
<h3>Future Directions:</h3>
<ul>
<li>Quantify embedding space distances for clonally related immunoglobulins to assess phylogenetic signal preservation</li>
<li>Develop cross-species protein language models incorporating mouse, camelid, and non-human primate immunoglobulin data for comparative immunogenomics</li>
<li>Train memory-specific models exclusively on hypermutated sequences to enhance affinity maturation signal detection</li>
</ul>
<h3>Immunoglobulin Structure and Function</h3>
<p>Immunoglobulins are tetrameric glycoproteins comprising two heavy chains and two light chains linked by disulfide bonds in a characteristic Y-shaped quaternary structure. The antigen-binding domain, formed by the variable heavy (VH) and variable light (VL) regions, determines specificity through complementarity-determining regions (CDRs) that contact cognate antigens.</p>
<p>The variable region is generated stochastically through a process called V(D)J recombination. This process involves the pseudo-random selection, recombination, and joining of gene segments—Variable (V), Diversity (D), and Joining (J) segments—along with the introduction of pseudo-random nucleotide insertions and deletions between the recombined genes. This generates astromomical standing antibody sequence diversity which could never be encoded in the genome. Selection of particular antibodies from this diversity allows indivuduals to adapt their immune system to never-before-seen pathogens.</p>
<h3>Antibody Evolution</h3>
<p>The antibody generation process creates a large pool standing diversity in protein space. Next, the immune system uses an evolutionary process to select and amplify the antibodies which have the most beneficial properties, such as strongly binding and neutralizing a pathogen which is wreaking havoc in your body. During the selection process, additional diversity is generated by mutating the selected antibodies, allowing the immune system iterate on creating an even better protein: it selects the best of the selected. This process is called somatic hypermuation, and it's pretty much fascinating.</p></div></article><footer class="mt-12 pt-8 border-t"></footer></div></div><!--/$--><script src="/_next/static/chunks/webpack-e7e2e9d366afa4de.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[7555,[],\"\"]\n3:I[1295,[],\"\"]\n4:I[6874,[\"874\",\"static/chunks/874-74901d351483b694.js\",\"858\",\"static/chunks/app/posts/%5Bslug%5D/page-f9e0a1a25b6c6997.js\"],\"\"]\n6:I[9665,[],\"OutletBoundary\"]\n9:I[9665,[],\"ViewportBoundary\"]\nb:I[9665,[],\"MetadataBoundary\"]\nd:I[6614,[],\"\"]\n:HL[\"/_next/static/media/558ca1a6aa3cb55e-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/css/8b338a9e5eebdb00.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"6akSNH7gX1Iw2tBTrj-Na\",\"p\":\"\",\"c\":[\"\",\"posts\",\"2023-03-04-antibodies\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"posts\",{\"children\":[[\"slug\",\"2023-03-04-antibodies\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/8b338a9e5eebdb00.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"className\":\"__variable_f9e569 antialiased font-mono bg-background text-foreground\",\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"div\",null,{\"className\":\"flex flex-col items-center justify-center min-h-screen p-4\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"text-4xl font-serif mb-4\",\"children\":\"404\"}],[\"$\",\"h2\",null,{\"className\":\"text-2xl mb-6\",\"children\":\"Page Not Found\"}],[\"$\",\"p\",null,{\"className\":\"mb-8 text-center\",\"children\":\"The page you are looking for doesn't exist or has been moved.\"}],[\"$\",\"$L4\",null,{\"href\":\"/\",\"className\":\"px-6 py-3 border border-neutral-200 hover:bg-primary/10 transition-colors\",\"children\":\"Return Home\"}]]}],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]}]]}],{\"children\":[\"posts\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"slug\",\"2023-03-04-antibodies\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L5\",\"$undefined\",null,[\"$\",\"$L6\",null,{\"children\":[\"$L7\",\"$L8\",null]}]]}],{},null,false]},null,false]},null,false]},[[\"$\",\"div\",\"l\",{\"className\":\"flex items-center justify-center min-h-screen\",\"children\":[\"$\",\"div\",null,{\"className\":\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary\"}]}],[],[]],false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"3Bh71ZF13ucp02JBQV5cM\",{\"children\":[[\"$\",\"$L9\",null,{\"children\":\"$La\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}],[\"$\",\"$Lb\",null,{\"children\":\"$Lc\"}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$d\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"e:T5b7,prose prose-lg max-w-none  prose-headings:font-serif prose-headings:font-semibold prose-headings:text-foreground prose-h1:text-3xl prose-h1:md:text-4xl prose-h1:mb-6 prose-h1:mt-8 prose-h2:text-2xl prose-h2:md:text-3xl prose-h2:mb-4 prose-h2:mt-8 prose-h3:text-xl prose-h3:md:text-2xl prose-h3:mb-3 prose-h3:mt-6 prose-p:text-base prose-p:md:text-lg prose-p:leading-relaxed prose-p:mb-6 prose-p:font-serif prose-p:text-muted-foreground prose-strong:font-semibold prose-strong:text-foreground prose-a:text-primary prose-a:no-underline hover:prose-a:underline prose-ul:mb-6 prose-ul:space-y-2 prose-li:text-base prose-li:md:text-lg prose-li:font-serif prose-li:text-muted-foreground prose-ol:mb-6 prose-ol:space-y-2 prose-blockquote:border-l-4 prose-blockquote:border-primary prose-blockquote:pl-4 prose-blockquote:italic prose-blockquote:text-muted-foreground prose-code:bg-[#fdf6e3] prose-code:text-[#657b83] prose-code:px-1 prose-code:py-0.5 prose-code:rounded prose-code:text-sm prose-code:font-mono prose-code:border prose-code:border-[#eee8d5] prose-pre:bg-[#fdf6e3] prose-pre:text-[#657b83] prose-pre:p-4 prose-pre:rounded-lg prose-pre:overflow-x-auto prose-pre:border prose-pre:border-[#eee8d5] prose-pre:shadow-sm prose-pre:font-mono prose-pre:text-sm prose-pre:leading-relaxed [\u0026_.hljs]:bg-transparent [\u0026_.hljs]:text-inherit prose-img:rounded-lg prose-img:shadow-sm prose-img:max-w-[60%] prose-img:mx-auto [\u0026_img]:max-w-[60%] [\u0026_img]:mx-auto [\u0026_img]:blockf:T2581,"])</script><script>self.__next_f.push([1,"\u003cp\u003e\u003cimg src=\"/images/posts/llm_antibody/llm_ir-writeup_38_0.png\" alt=\"png\"\u003e\u003c/p\u003e\n\u003cp\u003eI investigated the application of protein language models (PLMs) for immunoglobulin sequence analysis. Antibodies are adaptive immune proteins critical for pathogen neutralization. This study integrates B-cell receptor (BCR) sequencing data, AbLang (an antibody-specific protein language model), and single-cell RNA sequencing to explore computational approaches in immunoinformatics.\u003c/p\u003e\n\n\u003ch3\u003eProtein Language Models in Structural Biology\u003c/h3\u003e\n\u003cp\u003eProtein language models leverage transformer architectures adapted from natural language processing to analyze amino acid sequences. These models undergo unsupervised pre-training on large-scale protein databases, learning evolutionary constraints and structural motifs encoded in sequence space. Through self-attention mechanisms, they capture long-range amino acid dependencies critical for protein folding and function. The learned representations encode biophysical properties including secondary structure, solvent accessibility, and functional domains. I investigated their application to immunoglobulin evolution and somatic hypermutation analysis.\u003c/p\u003e\n\u003ch3\u003eAbLang: Antibody-Specific Protein Language Model\u003c/h3\u003e\n\u003cp\u003e\u003cimg src=\"/images/posts/llm_antibody/llm_ir-writeup_7_0.jpg\" alt=\"jpeg\"\u003e\u003c/p\u003e\n\u003cp\u003eAbLang is a domain-specific protein language model trained exclusively on immunoglobulin sequences, optimizing representations for antibody variable regions. While domain-specific models may capture immunoglobulin-specific evolutionary patterns, comparative analysis with general protein language models (e.g., ESM-2, ProtTrans) would provide valuable benchmarking for immunoinformatics applications.\u003c/p\u003e\n\u003ch3\u003eAdditional Background about Antibodies at the bottom:\u003c/h3\u003e\n\u003cp\u003eSomatic hypermutation frequency serves as a molecular marker of affinity maturation, with higher mutation loads indicating extensive germinal center selection and clonal evolution from naive B-cell precursors.\u003c/p\u003e\n\u003ch2\u003eOverview of my investigation:\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eintegrate single-cell transcriptomic profiles with AbLang-derived immunoglobulin embeddings\u003c/li\u003e\n\u003cli\u003eapply principal component analysis to protein language model representations\u003c/li\u003e\n\u003cli\u003eperform unsupervised clustering of immunoglobulin sequence embeddings\u003c/li\u003e\n\u003cli\u003econduct differential gene expression analysis using embedding-defined B-cell subpopulations\u003c/li\u003e\n\u003cli\u003egenerate low-dimensional visualizations via UMAP projection\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eProtein Language Models for Immunoglobulin Analysis in Single-Cell Genomics\u003c/h2\u003e\n\u003cp\u003eA Quick Look at the Dataset\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/images/posts/llm_antibody/llm_ir-writeup_18_0.png\" alt=\"png\"\u003e\u003c/p\u003e\n\u003cp\u003eThe dataset comprises hundreds to thousands of individual B cells per sample, each with paired single-cell transcriptomic profiles and cognate immunoglobulin heavy and light chain sequences.\u003c/p\u003e\n\u003cp\u003eThese UMAP projections demonstrate global coherence between transcriptomic states and immunoglobulin sequence characteristics:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eUMAP projections of single-cell transcriptomic data colored by B-cell developmental state (left) and immunoglobulin sequence features (right panels)\u003c/li\u003e\n\u003cli\u003eMemory B cells represent antigen-experienced populations with accumulated somatic hypermutations, while naive B cells maintain germline immunoglobulin sequences\u003c/li\u003e\n\u003cli\u003eMutation frequency is quantified as nucleotide divergence from inferred germline V(D)J gene segments\u003c/li\u003e\n\u003cli\u003eMemory B cells exhibit class switch recombination from IgM to downstream isotypes (IgG, IgA, IgE), indicating germinal center participation\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\u003cimg src=\"/images/posts/llm_antibody/llm_ir-writeup_21_1.png\" alt=\"png\"\u003e\u003c/p\u003e\n\u003cp\u003eImmunoglobulin sequence annotations demonstrate strong concordance with transcriptomically-defined B-cell subsets. Memory B cells predominantly harbor hypermutated immunoglobulin sequences, confirming the molecular signatures of germinal center-derived populations.\u003c/p\u003e\n\u003cp\u003eI investigated whether protein language model embeddings capture biologically meaningful immunoglobulin features including somatic hypermutation and isotype usage. The following PCA analysis examines these categorical variables within AbLang embedding space:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/images/posts/llm_antibody/llm_ir-writeup_26_0.png\" alt=\"png\"\u003e\u003c/p\u003e\n\u003cp\u003eThe protein language model demonstrates learned representations of somatic hypermutation, cleanly separating germline from hypermutated immunoglobulins along PC1 and PC3. PC3 reveals continuous variation within hypermutated sequence space, with a clear trajectory from IgM to class-switched isotypes (IgG, IgA). This suggests the model captures fundamental immunoglobulin biology including affinity maturation and class switch recombination.\u003c/p\u003e\n\u003cp\u003eQuantitative analysis of somatic hypermutation along principal components, particularly PC3 which separates IgM from class-switched isotypes, reveals corresponding patterns in transcriptomic space:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/images/posts/llm_antibody/llm_ir-writeup_29_1.png\" alt=\"png\"\u003e\u003c/p\u003e\n\u003cp\u003eAs an aside, we can see a fair amount of \"no mutation\" antibody sequences (highighted in the red box or seen in the tail of the orange distribtion) that actually appear more like mutated antibodies in the PC space. I asked if the gene expression of cells with that profile looked like Memory B cells, which would corroborate that the antibody actually is hypermutated. Indeed these cells with \"no mutations\" appear to have a memory-like phenotype, suggesting the language model identifies mutations in antibodies more sensitively than how I orginally labeled the mutation status, via comparison to a genomic database.\u003c/p\u003e\n\u003cp\u003eI noticed from some exploratory plots that the while the distribution of hypermutated antibodies on PC3 doesn't appear to have any notable features, if I subset different cell types, multiple modes appear. For example, hypermutated Memory B cells appear to have multple two modes in PC3\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/images/posts/llm_antibody/llm_ir-writeup_32_1.png\" alt=\"png\"\u003e\u003c/p\u003e\n\u003cp\u003eI split the hypermutated Memory B cells at 1 in PC3 space and asked if there were gene expression differences between the groups\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/images/posts/llm_antibody/llm_ir-writeup_35_1.png\" alt=\"png\"\u003e\u003c/p\u003e\n\u003cp\u003eIndeed there are clear differences, with PC3 low having a IGHM memory phenotype and PC3 high  deeper or class-switched memory phenotype\u003c/p\u003e\n\u003cp\u003eLet's finally take a quick look at the UMAP projection of the antibody sequence encodings\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/images/posts/llm_antibody/llm_ir-writeup_38_0.png\" alt=\"png\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/images/posts/llm_antibody/llm_ir-writeup_38_1.png\" alt=\"png\"\u003e\u003c/p\u003e\n\u003cp\u003eUMAP projection demonstrates clustering by V gene family usage alongside somatic hypermutation levels. Immunoglobulin sequences cluster by germline V gene origin, with secondary separation of hypermutated variants within each gene family, reflecting both germline diversity and somatic evolution.\u003c/p\u003e\n\u003ch3\u003eSummary:\u003c/h3\u003e\n\u003cp\u003eThis immunoinformatics analysis demonstrates that protein language models capture biologically relevant immunoglobulin features:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eAbLang embeddings encode somatic hypermutation along orthogonal dimensions\u003c/li\u003e\n\u003cli\u003eBinary germline vs. hypermutated classification along one axis\u003c/li\u003e\n\u003cli\u003eContinuous mutation load quantification along another axis\u003c/li\u003e\n\u003cli\u003eEmbedding-based immunoglobulin clustering correlates with independent transcriptomic B-cell phenotypes\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eFuture Directions:\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eQuantify embedding space distances for clonally related immunoglobulins to assess phylogenetic signal preservation\u003c/li\u003e\n\u003cli\u003eDevelop cross-species protein language models incorporating mouse, camelid, and non-human primate immunoglobulin data for comparative immunogenomics\u003c/li\u003e\n\u003cli\u003eTrain memory-specific models exclusively on hypermutated sequences to enhance affinity maturation signal detection\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eImmunoglobulin Structure and Function\u003c/h3\u003e\n\u003cp\u003eImmunoglobulins are tetrameric glycoproteins comprising two heavy chains and two light chains linked by disulfide bonds in a characteristic Y-shaped quaternary structure. The antigen-binding domain, formed by the variable heavy (VH) and variable light (VL) regions, determines specificity through complementarity-determining regions (CDRs) that contact cognate antigens.\u003c/p\u003e\n\u003cp\u003eThe variable region is generated stochastically through a process called V(D)J recombination. This process involves the pseudo-random selection, recombination, and joining of gene segments—Variable (V), Diversity (D), and Joining (J) segments—along with the introduction of pseudo-random nucleotide insertions and deletions between the recombined genes. This generates astromomical standing antibody sequence diversity which could never be encoded in the genome. Selection of particular antibodies from this diversity allows indivuduals to adapt their immune system to never-before-seen pathogens.\u003c/p\u003e\n\u003ch3\u003eAntibody Evolution\u003c/h3\u003e\n\u003cp\u003eThe antibody generation process creates a large pool standing diversity in protein space. Next, the immune system uses an evolutionary process to select and amplify the antibodies which have the most beneficial properties, such as strongly binding and neutralizing a pathogen which is wreaking havoc in your body. During the selection process, additional diversity is generated by mutating the selected antibodies, allowing the immune system iterate on creating an even better protein: it selects the best of the selected. This process is called somatic hypermuation, and it's pretty much fascinating.\u003c/p\u003e"])</script><script>self.__next_f.push([1,"5:[\"$\",\"div\",null,{\"className\":\"min-h-screen bg-background\",\"children\":[\"$\",\"div\",null,{\"className\":\"max-w-4xl mx-auto px-6 py-12\",\"children\":[[\"$\",\"$L4\",null,{\"href\":\"/#posts\",\"className\":\"inline-flex items-center gap-2 text-sm text-muted-foreground hover:text-foreground mb-8 transition-colors\",\"children\":[[\"$\",\"svg\",null,{\"ref\":\"$undefined\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":16,\"height\":16,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-arrow-left\",\"aria-hidden\":\"true\",\"children\":[[\"$\",\"path\",\"1l729n\",{\"d\":\"m12 19-7-7 7-7\"}],[\"$\",\"path\",\"x3x0zl\",{\"d\":\"M19 12H5\"}],\"$undefined\"]}],\"Back to posts\"]}],[\"$\",\"header\",null,{\"className\":\"mb-8\",\"children\":[[\"$\",\"div\",null,{\"className\":\"mb-4\",\"children\":[\"$undefined\",[\"$\",\"h1\",null,{\"className\":\"text-4xl md:text-5xl font-serif font-bold leading-tight\",\"children\":\"Protein Language Models for Immunoglobulin Sequence Analysis\"}]]}],[\"$\",\"div\",null,{\"className\":\"text-muted-foreground\",\"children\":\"March 4, 2023\"}],[\"$\",\"div\",null,{\"className\":\"flex flex-wrap gap-2 mt-4\",\"children\":[[\"$\",\"span\",\"protein-language-models\",{\"className\":\"px-2 py-1 text-xs bg-secondary text-secondary-foreground rounded\",\"children\":\"protein-language-models\"}],[\"$\",\"span\",\"computational-biology\",{\"className\":\"px-2 py-1 text-xs bg-secondary text-secondary-foreground rounded\",\"children\":\"computational-biology\"}],[\"$\",\"span\",\"immunoinformatics\",{\"className\":\"px-2 py-1 text-xs bg-secondary text-secondary-foreground rounded\",\"children\":\"immunoinformatics\"}],[\"$\",\"span\",\"single-cell-transcriptomics\",{\"className\":\"px-2 py-1 text-xs bg-secondary text-secondary-foreground rounded\",\"children\":\"single-cell-transcriptomics\"}],[\"$\",\"span\",\"antibody-repertoire\",{\"className\":\"px-2 py-1 text-xs bg-secondary text-secondary-foreground rounded\",\"children\":\"antibody-repertoire\"}],[\"$\",\"span\",\"somatic-hypermutation\",{\"className\":\"px-2 py-1 text-xs bg-secondary text-secondary-foreground rounded\",\"children\":\"somatic-hypermutation\"}],[\"$\",\"span\",\"immunoglobulin-analysis\",{\"className\":\"px-2 py-1 text-xs bg-secondary text-secondary-foreground rounded\",\"children\":\"immunoglobulin-analysis\"}]]}]]}],[\"$\",\"article\",null,{\"className\":\"$e\",\"children\":[\"$\",\"div\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$f\"}}]}],[\"$\",\"footer\",null,{\"className\":\"mt-12 pt-8 border-t\"}]]}]}]\n"])</script><script>self.__next_f.push([1,"a:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n7:null\n"])</script><script>self.__next_f.push([1,"8:null\nc:[[\"$\",\"title\",\"0\",{\"children\":\"Protein Language Models for Immunoglobulin Sequence Analysis | Michael Swift\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"Do protein language models capture meaningful features of antibody sequences?\"}],[\"$\",\"link\",\"2\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"128x128\"}]]\n"])</script></body></html>